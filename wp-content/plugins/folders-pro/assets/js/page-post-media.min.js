!function(e){"use strict";"function"==typeof define&&define.amd?define(["jquery"],e):"undefined"!=typeof module&&module.exports?module.exports=e(require("jquery")):e(jQuery)}(function(e,t){var o,s,a="",l=".folder-modal #js-tree-menu",r=[],d=-1,n=0,c=0,m="",p=-1,u=0,f="",h=folders_media_options.page_url,v="",g="",k=!1,y=!1,j=!1,w=0,b=0,x=[],C=null,S=null,I=0,P=wp.media.view.AttachmentFilters.extend({id:"media-attachment-taxonomy-filter",createFilters:function(){var e={};folders_media_options.terms.length;_.each(folders_media_options.terms||{},function(t,o){e[t.term_id]={text:t.name+" ("+t.count+")",props:{media_folder:t.slug}}}),e.all={text:"All Folders",props:{media_folder:""},priority:10},e.unassigned={text:"(Unassigned)",props:{media_folder:"-1"},priority:10},this.filters=e},change:function(){var e={};_.each(folders_media_options.terms||{},function(t,o){e[t.term_id]={text:t.name+" ("+t.count+")",props:{media_folder:t.slug}}}),e.all={text:"Select a folder >>",props:{media_folder:""},priority:10},e.unassigned={text:"(Unassigned)",props:{media_folder:"-1"},priority:10},this.filters=e;var t=this.filters[this.el.value];t&&this.model.set(t.props)}}),D=0,A=0,H=wp.media.view.AttachmentsBrowser;wp.media.view.AttachmentsBrowser=wp.media.view.AttachmentsBrowser.extend({createToolbar:function(){H.prototype.createToolbar.call(this),this.toolbar.set("MediaLibraryOrganizerTaxonomyFilter",new P({controller:this.controller,model:this.collection.props,priority:-75}).render())}});var N,F=wp.media.model.Query;_.extend(F,{get:(N=[],function(e,t){var o,s={},a=F.orderby,l=F.defaultProps;return delete e.query,delete e.cache,_.defaults(e,l),_.each(["include","exclude"],function(t){e[t]&&!_.isArray(e[t])&&(e[t]=[e[t]])}),_.each(e,function(e,t){_.isNull(e)||(s[F.propmap[t]||t]=e)}),_.defaults(s,F.defaultArgs),s.orderby=a.valuemap[e.orderby]||e.orderby,N=[],o||(o=new F([],_.extend(t||{},{props:e,args:s})),N.push(o)),o})});var O=window.wp;void 0!==O&&"function"==typeof O.Uploader&&(O.media.view.Modal.prototype.on("open",function(){a="",setTimeout(function(){e("#media-attachment-taxonomy-filter").length&&("all"==e("#media-attachment-taxonomy-filter").val()&&(e("#media-attachment-taxonomy-filter option:gt(1)").remove(),_.each(folders_media_options.terms,function(t,o){e("#media-attachment-taxonomy-filter").append("<option value='"+t.term_id+"'>"+t.name+" ("+t.trash_count+")</option>")})),e("#wcp-content").length||e(".editor-post-featured-image").length&&e(".attachment-filters").val("all").trigger("change"))},100)}),O.media.view.Modal.prototype.on("close",function(){a=""}),e.extend(O.Uploader.prototype,{progress:function(){},init:function(){this.uploader&&(this.uploader.bind("FileFiltered",function(t,o){D++,e(".folder-meter").css("width","0%"),e(".media-folder-loader").show(),e("#total_upload_files").text(D)}),this.uploader.bind("BeforeUpload",function(t,o){var s=d,a=t.settings.multipart_params;if((s=parseInt(s))>0&&(a.folder_for_media=s),A<D){e(".media-folder-loader").show();var l=A/D*100;e(".folder-meter").css("width",l+"%")}A++,e("#current_upload_files").text(A)}),this.uploader.bind("UploadComplete",function(e,t){d=-1}),this.uploader.bind("UploadComplete",function(t,o){var s=window.wp;e(".folder-meter").css("width","100%"),setTimeout(function(){e(".media-folder-loader").hide(),e(".folder-meter").css("width","0%"),D=0,A=0},1250),function(){e("#media-attachment-taxonomy-filter").val();J=e.ajax({url:folders_media_options.ajax_url,data:"type=attachment&action=wcp_get_default_list&active_id=0",method:"post",beforeSend:function(){null!=J&&J.abort()},success:function(t){var t=e.parseJSON(t);x=t.taxonomies,X(),L()}})}(),void 0!==s.media.frame&&null!==s.media.frame.content.get()?(a="",e(".folder-modal ul.attachments li.selected").length&&(a=e(".folder-modal ul.attachments li.selected").data("id")),s.media.frame.content.get().collection.props.set({ignore:+new Date}),s.media.frame.content.get().options.selection.reset()):e("#media-attachment-taxonomy-filter").length&&e(".attachment-filters").each(function(){e(this).trigger("change")})}))}}));var J,U=window.wp;if(void 0!==U&&"function"==typeof U.Uploader){var M=window.wp.media,Q=M.view.Modal;M.view.Modal=M.view.Modal.extend({className:"folder-modal",initialize:function(){Q.prototype.initialize.apply(this,arguments)},open:function(){Q.prototype.open.apply(this,arguments)&&(e(".folder-modal").length||e(".supports-drag-drop").length&&e(".supports-drag-drop").each(function(){"block"!=e(this).css("display")&&"inline-block"!=e(this).css("display")||e(this).addClass("folder-modal")}),e(".folder-modal").length?(e(".folder-custom-menu").remove(),e(".folder-modal .media-frame-tab-panel").removeClass("has-folder-menu"),e(".folder-modal .media-frame").hasClass("hide-menu")?e(".folder-custom-menu").length||(e(".folder-modal .media-frame-tab-panel").before("<div class='folder-custom-menu'><div class='folder-menu-content'><div class='cssload-container'><div class='cssload-tube-tunnel'></div></div></div></div>"),e(".folder-modal .folder-menu-content").load(folders_media_options.media_page_url+" #wcp-content-resize",function(){K(),Y(),T()})):e(".folder-custom-menu").length||(e(".folder-modal .media-frame-menu").addClass("has-folder-menu"),e(".folder-modal .media-frame-menu .media-menu").append("<div class='folder-custom-menu'><div class='folder-menu-content'><div class='cssload-container'><div class='cssload-tube-tunnel'></div></div></div></div>"),e(".folder-modal .folder-menu-content").load(folders_media_options.media_page_url+" #wcp-content-resize",function(){K(),Y(),T()})),e(".folder-form-data").remove(),e(".media-frame-tab-panel:first").before("<div class='folder-form-data'></div>"),e(".folder-form-data").load(folders_media_options.media_page_url+" #folder-add-update-content",function(){})):setTimeout(function(){-1!=d&&e("#media-attachment-taxonomy-filter").each(function(){e(this).val(d),e(this).trigger("change")})},1e3))},close:function(){Q.prototype.close.apply(this,arguments),e(".folder-modal").removeClass("folder-modal")}})}function L(){e(".jstree-anchor:not(.ui-droppable)").droppable({accept:".wcp-move-file, .wcp-move-multiple, .attachments-browser li.attachment",hoverClass:"wcp-drop-hover",classes:{"ui-droppable-active":"ui-state-highlight"},drop:function(t,o){n=e(this).closest("li.jstree-node").attr("id"),o.draggable.hasClass("wcp-move-multiple")?e(".wp-list-table input:checked").length&&(chkStr="",e(".wp-list-table input:checked").each(function(){chkStr+=e(this).val()+","}),f=V(n,"nonce"),e.ajax({url:folders_media_options.ajax_url,data:"post_ids="+chkStr+"&type="+folders_media_options.post_type+"&action=wcp_change_multiple_post_folder&folder_id="+n+"&nonce="+f+"&status="+folders_media_options.taxonomy_status+"&taxonomy="+v,method:"post",success:function(t){"1"==(t=e.parseJSON(t)).status?B():(e(".folder-popup-form").hide(),e(".folder-popup-form").removeClass("disabled"),e("#error-folder-popup-message").html(t.message),e("#error-folder-popup").show())}})):o.draggable.hasClass("wcp-move-file")?(postID=o.draggable[0].attributes["data-id"].nodeValue,f=V(n,"nonce"),chkStr=postID+",",e(".wp-list-table input:checked").each(function(){e(this).val()!=postID&&(chkStr+=e(this).val()+",")}),e.ajax({url:folders_media_options.ajax_url,data:"post_ids="+chkStr+"&type="+folders_media_options.post_type+"&action=wcp_change_multiple_post_folder&folder_id="+n+"&nonce="+f+"&status="+folders_media_options.taxonomy_status+"&taxonomy="+v,method:"post",success:function(t){"1"==(t=e.parseJSON(t)).status?B():(e(".folder-popup-form").hide(),e(".folder-popup-form").removeClass("disabled"),e("#error-folder-popup-message").html(t.message),e("#error-folder-popup").show())}})):o.draggable.hasClass("attachment")&&(chkStr=o.draggable[0].attributes["data-id"].nodeValue,f=V(n,"nonce"),e(".attachments-browser li.attachment.selected").length>1&&(chkStr="",e(".attachments-browser li.attachment.selected").each(function(){chkStr+=e(this).data("id")+","})),g=chkStr,e.ajax({url:folders_media_options.ajax_url,data:"post_ids="+chkStr+"&type="+folders_media_options.post_type+"&action=wcp_change_multiple_post_folder&folder_id="+n+"&nonce="+f+"&status="+folders_media_options.taxonomy_status+"&taxonomy="+v,method:"post",success:function(e){B(),ee()}}))}}),e(".media-frame:not(.hide-router) .attachments-browser li.attachment:not(.ui-draggable)").draggable({revert:"invalid",containment:"document",helper:function(t,o){e(".selected-items").remove();var s=e(".media-frame:not(.hide-router) .attachments-browser li.attachment.selected").length;return e("<div class='selected-items'><span class='total-post-count'>"+(s=0==s||1==s?"1 Item":s+" Items")+" Selected</span></div>")},start:function(t,o){e("body").addClass("no-hover-css")},cursor:"move",appendTo:".media-modal",cursorAt:{left:0,top:0},stop:function(t,o){e(".selected-items").remove(),e("body").removeClass("no-hover-css")}}),e(".un-categorised-items").droppable({accept:".wcp-move-file, .wcp-move-multiple, .attachments-browser li.attachment",hoverClass:"wcp-hover-list",classes:{"ui-droppable-active":"ui-state-highlight"},drop:function(t,o){n=-1,f=folders_media_options.nonce,o.draggable.hasClass("wcp-move-multiple")?e(".wp-list-table input:checked").length&&(chkStr="",e(".wp-list-table input:checked").each(function(){chkStr+=e(this).val()+","}),e.ajax({url:folders_media_options.ajax_url,data:"post_id="+chkStr+"&type="+folders_media_options.post_type+"&action=wcp_remove_post_folder&folder_id="+n+"&nonce="+f+"&status="+folders_media_options.taxonomy_status+"&taxonomy="+v,method:"post",success:function(e){B()}})):o.draggable.hasClass("wcp-move-file")?(postID=o.draggable[0].attributes["data-id"].nodeValue,chkStr=postID+",",e(".wp-list-table input:checked").each(function(){postID!=e(this).val()&&(chkStr+=e(this).val()+",")}),e.ajax({url:folders_media_options.ajax_url,data:"post_id="+chkStr+"&type="+folders_media_options.post_type+"&action=wcp_remove_post_folder&folder_id="+n+"&nonce="+f+"&status="+folders_media_options.taxonomy_status+"&taxonomy="+v,method:"post",success:function(e){B()}})):o.draggable.hasClass("attachment")&&(chkStr=o.draggable[0].attributes["data-id"].nodeValue,e(".attachments-browser li.attachment.selected").length>1&&(chkStr="",e(".attachments-browser li.attachment.selected").each(function(){chkStr+=e(this).data("id")+","})),g=chkStr,e.ajax({url:folders_media_options.ajax_url,data:"post_id="+chkStr+"&type="+folders_media_options.post_type+"&action=wcp_remove_post_folder&folder_id="+n+"&nonce="+f+"&status="+folders_media_options.taxonomy_status+"&taxonomy="+v,method:"post",success:function(e){B()}}))}}),e(".tree-structure .folder-item:not(.ui-droppable)").droppable({accept:".wcp-move-file, .wcp-move-multiple, .attachments-browser li.attachment",hoverClass:"wcp-drop-hover-list",classes:{"ui-droppable-active":"ui-state-highlight"},drop:function(t,o){e("body").removeClass("no-hover-css"),n=e(this).data("id"),o.draggable.hasClass("wcp-move-multiple")?(f=V(n,"nonce"),e(".wp-list-table input:checked").length&&(chkStr="",e(".wp-list-table input:checked").each(function(){chkStr+=e(this).val()+","}),e.ajax({url:folders_media_options.ajax_url,data:"post_ids="+chkStr+"&type="+folders_media_options.post_type+"&action=wcp_change_multiple_post_folder&folder_id="+n+"&nonce="+f+"&status="+folders_media_options.taxonomy_status+"&taxonomy="+v,method:"post",success:function(e){B(),ee()}}))):o.draggable.hasClass("wcp-move-file")?(postID=o.draggable[0].attributes["data-id"].nodeValue,f=V(n,"nonce"),chkStr=postID+",",e(".wp-list-table input:checked").each(function(){e(this).val()!=postID&&(chkStr+=e(this).val()+",")}),e.ajax({url:folders_media_options.ajax_url,data:"post_ids="+chkStr+"&type="+folders_media_options.post_type+"&action=wcp_change_multiple_post_folder&folder_id="+n+"&nonce="+f+"&status="+folders_media_options.taxonomy_status+"&taxonomy="+v,method:"post",success:function(e){B(),ee()}})):o.draggable.hasClass("attachment")&&(chkStr=o.draggable[0].attributes["data-id"].nodeValue,f=V(n,"nonce"),e(".attachments-browser li.attachment.selected").length>1&&(chkStr="",e(".attachments-browser li.attachment.selected").each(function(){chkStr+=e(this).data("id")+","})),e.ajax({url:folders_media_options.ajax_url,data:"post_ids="+chkStr+"&type="+folders_media_options.post_type+"&action=wcp_change_multiple_post_folder&folder_id="+n+"&nonce="+f+"&status="+folders_media_options.taxonomy_status+"&taxonomy="+v,method:"post",success:function(e){B(),ee()}}))}}),e(".wcp-move-file:not(.ui-draggable)").draggable({revert:"invalid",containment:"document",helper:"clone",cursor:"move",start:function(t,o){e(this).closest("td").addClass("wcp-draggable"),e("body").addClass("no-hover-css")},stop:function(t,o){e(this).closest("td").removeClass("wcp-draggable"),e("body").removeClass("no-hover-css")}}),e(".wcp-move-multiple:not(.ui-draggable)").draggable({revert:"invalid",containment:"document",helper:function(t,o){return e(".selected-items").remove(),selectedItems=e("#the-list th input:checked").length,selectedItems>0?(selectedItems=0==selectedItems||1==selectedItems?"1 Item":selectedItems+" Items",e("<div class='selected-items'><span class='total-post-count'>"+selectedItems+" Selected</span></div>")):e("<div class='selected-items'><span class='total-post-count'>Select Items to move</span></div>")},start:function(t,o){e("body").addClass("no-hover-css")},cursor:"move",cursorAt:{left:0,top:0},stop:function(t,o){e(".selected-items").remove(),e("body").removeClass("no-hover-css")}}),e(".sticky-folders > ul > li > a:not(.ui-droppable)").droppable({accept:".wcp-move-file, .wcp-move-multiple, .media-frame:not(.hide-router) .attachments-browser li.attachment",hoverClass:"wcp-drop-hover",classes:{"ui-droppable-active":"ui-state-highlight"},drop:function(t,o){if(n=e(this).closest("li").data("folder-id"),o.draggable.hasClass("wcp-move-multiple")){if(e(".wp-list-table input:checked").length){var s="";e(".wp-list-table input:checked").each(function(){s+=e(this).val()+","}),f=V(n,"nonce"),e.ajax({url:folders_media_options.ajax_url,data:"post_ids="+s+"&type="+folders_media_options.post_type+"&action=wcp_change_multiple_post_folder&folder_id="+n+"&nonce="+f+"&status="+folders_media_options.taxonomy_status+"&taxonomy="+v,method:"post",success:function(t){"1"==(t=e.parseJSON(t)).status?(B(),ee()):(e(".folder-popup-form").hide(),e(".folder-popup-form").removeClass("disabled"),e("#error-folder-popup-message").html(t.message),e("#error-folder-popup").show())}})}}else if(o.draggable.hasClass("wcp-move-file")){var a=o.draggable[0].attributes["data-id"].nodeValue;f=V(n,"nonce"),s=a+",",e(".wp-list-table input:checked").each(function(){e(this).val()!=a&&(s+=e(this).val()+",")}),e.ajax({url:folders_media_options.ajax_url,data:"post_ids="+s+"&type="+folders_media_options.post_type+"&action=wcp_change_multiple_post_folder&folder_id="+n+"&nonce="+f+"&status="+folders_media_options.taxonomy_status+"&taxonomy="+v,method:"post",success:function(t){"1"==(t=e.parseJSON(t)).status?(B(),ee()):(e(".folder-popup-form").hide(),e(".folder-popup-form").removeClass("disabled"),e("#error-folder-popup-message").html(t.message),e("#error-folder-popup").show())}})}else if(o.draggable.hasClass("attachment")){s=o.draggable[0].attributes["data-id"].nodeValue;f=V(n,"nonce"),e(".media-frame:not(.hide-router) .attachments-browser li.attachment.selected").length>1&&(s="",e(".media-frame:not(.hide-router) .attachments-browser li.attachment.selected").each(function(){s+=e(this).data("id")+","})),g=s,e.ajax({url:folders_media_options.ajax_url,data:"post_ids="+s+"&type="+folders_media_options.post_type+"&action=wcp_change_multiple_post_folder&folder_id="+n+"&nonce="+f+"&status="+folders_media_options.taxonomy_status+"&taxonomy="+v,method:"post",success:function(e){B(),ee()}})}}})}function T(){e(l).jstree({core:{cache:!1,animation:0,check_callback:function(t,o,s,a,l){if(e("*").removeClass("drag-bot").removeClass("drag-in").removeClass("drag-up"),("move_node"===t||"copy_node"===t)&&l&&l.dnd)switch(l.pos){case"a":l.origin.get_node(l.ref,!0).addClass("drag-bot"),nodeId=e(".drag-bot").attr("id"),e("#jstree-dnd").text("Below "+e.trim(e("#js-tree-menu").jstree(!0).get_node(nodeId).text));break;case"i":l.origin.get_node(l.ref,!0).addClass("drag-in"),nodeId=e(".drag-in").attr("id"),e("#jstree-dnd").text("Inside "+e.trim(e("#js-tree-menu").jstree(!0).get_node(nodeId).text));break;case"b":l.origin.get_node(l.ref,!0).addClass("drag-up"),nodeId=e(".drag-up").attr("id"),e("#jstree-dnd").text("Above "+e.trim(e("#js-tree-menu").jstree(!0).get_node(nodeId).text));break;default:e("#jstree-dnd").text(e("#jstree-dnd").data("txt"))}return!0}},dnd:{is_draggable:function(t){return folderMoveId=t[0].id,!e(".jstree-node[id='"+folderMoveId+"']").length||!e(".jstree-node[id='"+folderMoveId+"']").hasClass("is-locked")}},data:{cache:!1},select_node:!1,search:{show_only_matches:!0,case_sensitive:!1,fuzzy:!1},plugins:["dnd","search","contextmenu"],contextmenu:{select_node:0,show_at_node:0,items:function(){return{}}}}).bind("ready.jstree",function(){!function(){e("#js-tree-menu .jstree-node").each(function(){var t=parseInt(e(this).data("count"));t>0&&e(".jstree-node[id='"+e(this).attr("id")+"'] > a span.premio-folder-count").text(t)}),""!=v&&0!=v&&e(".jstree-node[id='"+v+"']").length&&(e("#js-tree-menu").jstree("select_node",v),e(".sticky-folders .sticky-folder-"+v+" a").length&&e(".sticky-folders .sticky-folder-"+v+" a").addClass("active-item"));e(".ajax-preloader").hide(),e(".js-tree-data").show(),Y(),E(),e(".sticky-folders ul > li").length>0&&e(".sticky-folders").addClass("active");R()}(),L(),E()}).bind("after_open.jstree",function(){L()}).bind("open_all.jstree",function(){L()}).bind("create_node.jstree",function(){L()}).bind("delete_node.jstree",function(){L()}).bind("close_all.jstree",function(){L()}).bind("after_close.jstree",function(){L()}).bind("move_node.jstree",function(t,o){"#"!=o.node.parent&&jQuery("#js-tree-menu").jstree("open_node",o.node.parent),folderMoveId=o.node.id,orderString="",e(".folder-modal .jstree-node[id='"+folderMoveId+"']").closest("ul").children().each(function(){"undefined"!=e(this).attr("id")&&(orderString+=e(this).attr("id")+",")}),e(".folder-modal #"+folderMoveId+"_anchor").closest(".jstree-node").parent().parent().hasClass("jstree-node")?parentID=e("#"+folderMoveId+"_anchor").closest(".jstree-node").parent().parent().attr("id"):parentID=0,""!=orderString&&(e(".form-loader-count").css("width","100%"),e.ajax({url:folders_media_options.ajax_url,data:"term_ids="+orderString+"&action=wcp_save_folder_order&type="+folders_media_options.post_type+"&nonce="+folders_media_options.nonce+"&term_id="+folderMoveId+"&parent_id="+parentID,method:"post",success:function(t){"1"==(t=e.parseJSON(t)).status?(e("#wcp_folder_parent").html(t.options),e(".form-loader-count").css("width","0"),B(),ee(),X(),L()):(e(".folder-popup-form").hide(),e(".folder-popup-form").removeClass("disabled"),e("#error-folder-popup-message").html(t.message),e("#error-folder-popup").show(),window.location.reload(!0))}}))}),L()}function V(e,t){if(r.length>0)for(i=0;i<r.length;i++)if(parseInt(r[i].folder_id)==parseInt(e))return r[i][t];return""}function z(e){if(r.length>0)for(i=0;i<r.length;i++)if(parseInt(r[i].folder_id)==parseInt(e))return i;return null}function E(){e(".sticky-folders > ul").html("");var t="";if(e("#js-tree-menu li.jstree-node.is-sticky").each(function(){var o=e(this).attr("id"),s=e.trim(e("#js-tree-menu").jstree(!0).get_node(o).text),a=e("#"+o+"_anchor .premio-folder-count").text(),l=e("li.jstree-node[id='"+o+"']").hasClass("is-high")?" is-high ":"",r=e("li.jstree-node[id='"+o+"']").hasClass("is-locked")?" is-locked ":"";t+="<li data-folder-id='"+o+"' class='sticky-fldr "+l+" "+r+" sticky-folder-"+o+"'><a href='javascript:;'><span class='folder-title'>"+s+"</span><span class='folder-actions'><span class='update-inline-record'><i class='pfolder-edit-folder'></i></span><span class='star-icon'><i class='pfolder-star'></i></span><span class='dashicons dashicons-lock'></span><span class='premio-folder-count'>"+a+"</span></span></a></li>"}),e(".sticky-folders > ul").html(t),e(".jstree-anchor.jstree-clicked").length){var o=e(".jstree-anchor.jstree-clicked").closest("li.jstree-node").attr("id");e(".sticky-folders .sticky-folder-"+o+" a").addClass("active-item")}e(".sticky-folders > ul > li").length>0?e(".sticky-folders").addClass("active"):e(".sticky-folders").removeClass("active")}function Y(){var t=0;if(e("#custom-scroll-menu").hasClass("mCustomScrollbar")){var o=jQuery("#custom-scroll-menu"),s=o.find(".mCSB_dragger"),a=o.find(".mCSB_container").height();t=s.position().top/(o.height()-s.height())*(a-o.height()),e("#custom-scroll-menu").mCustomScrollbar("destroy")}var l=jQuery(".folder-modal .media-modal-content").height()-e(".folder-modal .sticky-wcp-custom-form").height()-40;e(".folder-modal #custom-scroll-menu").closest(".media-frame-menu").length&&jQuery(".folder-custom-menu").length&&jQuery(".media-frame-menu").length&&(l=jQuery(".folder-modal .media-modal-content").height()-e(".folder-modal .sticky-wcp-custom-form").height()-jQuery(".folder-custom-menu").offset().top+jQuery(".media-frame-menu").offset().top-40),l<0&&(l=350),e("#custom-scroll-menu").mCustomScrollbar({axis:"y",scrollButtons:{enable:!0},setHeight:l,theme:"3d",scrollbarPosition:"inside",scrollInertia:500,mouseWheelPixels:60}),0!=t&&jQuery("#custom-scroll-menu").mCustomScrollbar("scrollTo",t+"px",{scrollInertia:0})}function B(){if(e(".media-toolbar").hasClass("media-toolbar-mode-select")&&e("ul.attachments li.selected").length&&(e("ul.attachments li.selected").trigger("click"),e(".select-mode-toggle-button").trigger("click")),""!=g&&(e("#js-tree-menu a.jstree-clicked").length>0||"-1"==v)){if(e("#media-attachment-taxonomy-filter").length){g=g.split(",");for(var t=0;t<g.length;t++)""!=g[t]&&e(".attachments-browser li[data-id='"+g[t]+"']").remove()}g=""}e("#media-attachment-taxonomy-filter").length?$(0):(e.ajax({url:folders_media_options.ajax_url,data:"type="+folders_media_options.post_type+"&action=get_folders_default_list",method:"post",success:function(t){t=e.parseJSON(t),e(".header-posts .total-count").text(t.total_items),e(".un-categorised-items .total-count").text(t.empty_items),x=t.taxonomies,X()}}),e(".folder-loader-ajax").addClass("active"),e("#folder-posts-filter").length?e("#folder-posts-filter").load(h+" #posts-filter",function(){var t={Title:"",Url:h};history.pushState(t,t.Title,t.Url),"show"!=folders_media_options.show_in_page||e(".tree-structure").length||e(".wp-header-end").before('<div class="tree-structure-content"><div class="tree-structure"><ul></ul><div class="clear clearfix"></div></div></div>'),R(),function(){R(),e(".form-loader-count").css("width","0"),"object"==typeof inlineEditPost&&(inlineEditPost.init(),e("#the-list").on("click",".editinline",function(){e(this).attr("aria-expanded","true"),inlineEditPost.edit(this)}),e(document).on("click",".inline-edit-save .save",function(){var t=e(this).closest("tr").attr("id");t=(t=t.replace("edit-","")).replace("post-",""),inlineEditPost.save(t)}),e(document).on("click",".inline-edit-save .cancel",function(){var t=e(this).closest("tr").attr("id");t=(t=t.replace("edit-","")).replace("post-",""),inlineEditPost.revert(t)}));"attachment"==folders_media_options.post_type&&(e(".move-to-folder-top").length||e("#bulk-action-selector-top").append("<option class='move-to-folder-top' value='move_to_folder'>Move to Folder</option>"),e(".move-to-folder-bottom").length||e("#bulk-action-selector-bottom").append("<option class='move-to-folder-bottom' value='move_to_folder'>Move to Folder</option>"))}()}):e("#wpbody").load(h+" #wpbody-content",!1,function(t){var o={Title:"",Url:h};history.pushState(o,o.Title,o.Url),"show"!=folders_media_options.show_in_page||e(".tree-structure").length||e(".wp-header-end").before('<div class="tree-structure-content"><div class="tree-structure"><ul></ul><div class="clear clearfix"></div></div></div>'),R()}))}function R(){r.length&&e("li.jstree-node").each(function(){folderPostId=z(e(this).attr("id")),null!=folderPostId&&(1==r[folderPostId].is_high?e(this).addClass("is-high"):e(this).removeClass("is-high"),1==r[folderPostId].is_locked?e(this).addClass("is-locked"):e(this).removeClass("is-locked"),1==r[folderPostId].is_sticky?e(this).addClass("is-sticky"):e(this).removeClass("is-sticky"))})}function X(){if(R(),E(),e("#media-attachment-taxonomy-filter").length&&(e("#media-attachment-taxonomy-filter").each(function(){folders_media_options.terms=x;var t=e(this);currentDDVal=e(this).val(),t.html("<option value='all'>All Folders</option><option value='unassigned'>(Unassigned)</option>"),x;for(var o=0;o<x.length;o++)t.append("<option value='"+x[o].term_id+"'>"+x[o].name+" ("+x[o].trash_count+")</option>");t.val(currentDDVal).trigger("change")}),e("select.folder_for_media").length)){var t=e("select.folder_for_media").val();e("select.folder_for_media option:not(:first-child):not(:last-child)").remove();for(var o=0;o<x.length;o++)e("select.folder_for_media option:last-child").before("<option value='"+x[o].term_id+"'>"+x[o].name+"</option>");""!=t&&e(".folder_for_media").val(t)}for(e("span.premio-folder-count").text(""),e(".folder-count").text(""),o=0;o<x.length;o++)0!=parseInt(x[o].trash_count)&&(e(".jstree-node[id='"+x[o].term_id+"'] > a.jstree-anchor span.premio-folder-count").text(x[o].trash_count),e(".sticky-folder-"+x[o].term_id+" .premio-folder-count").text(x[o].trash_count));""!=v&&e("#wcp_folder_"+v).addClass("active-item"),y&&(e("#title_"+c).trigger("click"),y=!1)}function q(){var t=e.trim(e("#folder-search").val());e("#js-tree-menu").jstree("search",t)}function Z(t){var o="Are you sure you want to delete the selected folder?",s="Items in the folder will not be deleted.";if(k=!1,1==t&&e("#folder-hide-show-checkbox").is(":checked")){var a=0;if(e("#js-tree-menu input.checkbox:checked").each(function(){e(this).closest("li.jstree-node").hasClass("is-locked")||a++}),0==a)return;if(k=!0,0==e("#js-tree-menu input.checkbox:checked").length)return e(".folder-popup-form").hide(),e(".folder-popup-form").removeClass("disabled"),e("#error-folder-popup-message").html("Please select at least one folder to delete"),void e("#error-folder-popup").show();e("#js-tree-menu input.checkbox:checked").length>1&&(o="Are you sure you want to delete the selected folders?",s="Items in the selected folders will not be deleted.")}e(".folder-popup-form").hide(),e(".folder-popup-form").removeClass("disabled"),e("#remove-folder-item").text("Yes, Delete it!"),e("#remove-folder-message").text(o),e("#remove-folder-notice").text(s),e("#confirm-remove-folder").show(),e("#remove-folder-item").focus()}function W(){folderName=e.trim(e("#js-tree-menu").jstree(!0).get_node(c).text),parentID=e("#wcp_folder_"+c).closest("li.jstree-node").data("folder-id"),parentID==t&&(parentID=0),e("#update-folder-data").text("Submit"),e(".folder-form-errors").removeClass("active"),e("#update-folder-item-name").val(folderName),e("#update-folder-item").removeClass("disabled"),e("#update-folder-item").show(),e("#update-folder-item-name").focus(),e(".dynamic-menu").remove()}function G(){if(0==u&&p>=10)return e("#folder-limitation-message").html("You've reached the 10 folder limitation!"),e("#no-more-folder-credit").show(),!1;e("#add-update-folder-title").text("Add new folder"),e("#save-folder-data").text("Submit"),e(".folder-form-errors").removeClass("active"),e("#add-update-folder-name").val(""),j&&(w=c,e("#add-update-folder-name").val(e.trim(e("#js-tree-menu").jstree(!0).get_node(c).text)+" #2"),c=e("#"+c+"_anchor").closest(".jstree-node").parent().parent().hasClass("jstree-node")?e("#"+c+"_anchor").closest(".jstree-node").parent().parent().attr("id"):0),e("#add-update-folder").removeClass("disabled"),e("#add-update-folder").show(),e("#add-update-folder-name").focus(),e(".dynamic-menu").remove()}function K(){setTimeout(function(){if(e("#js-tree-menu .jstree-node.jstree-leaf").length==e("#js-tree-menu .jstree-node").length)e("#expand-collapse-list").removeClass("all-open"),e("#expand-collapse-list").attr("data-folder-tooltip","Expand");else{var t=e("#js-tree-menu .jstree-node.jstree-closed").length+e("#js-tree-menu .jstree-node.jstree-open").length;e("#js-tree-menu .jstree-node.jstree-closed").length==t?(e("#expand-collapse-list").removeClass("all-open"),e("#expand-collapse-list").attr("data-folder-tooltip","Expand")):(e("#expand-collapse-list").addClass("all-open"),e("#expand-collapse-list").attr("data-folder-tooltip","Collapse"))}},500),L()}function $(o){J=e.ajax({url:folders_media_options.ajax_url,data:"type="+folders_media_options.post_type+"&action=wcp_get_default_list&active_id="+v,method:"post",beforeSend:function(){null!=J&&J.abort()},success:function(s){if(s=e.parseJSON(s),e(".header-posts .total-count").text(s.total_items),e(".un-categorised-items .total-count").text(s.empty_items),selectedVal=e("#media-attachment-taxonomy-filter").val(),"all"!=selectedVal&&1==o){var a=parent.wp;a.media!=t&&(a.media.frame.setState("insert"),null!==a.media.frame.content.get()?(a.media.frame.content.get().collection.props.set({ignore:+new Date}),a.media.frame.content.get().options.selection.reset()):a.media.frame.library.props.set({ignore:+new Date}))}x=s.taxonomies,X(),L()}})}function ee(){e(".folder-loader-ajax").addClass("active"),e(".folder-loader-ajax img").removeClass("active"),e(".folder-loader-ajax svg#successAnimation").addClass("active").addClass("animated"),setTimeout(function(){e(".folder-loader-ajax").removeClass("active"),e(".folder-loader-ajax img").addClass("active"),e(".folder-loader-ajax svg#successAnimation").removeClass("active").removeClass("animated")},2e3),E(),L()}e(document).ready(function(){o=parseInt(folders_media_options.hasStars),s=parseInt(folders_media_options.hasChildren),I=parseInt(folders_media_options.hasValidLicense),jQuery(document).on("click",".close-popup-button",function(t){e(".folder-popup-form").hide()}),jQuery(document).on("click",".thumbnail-hover-box a",function(t){return t.stopPropagation(),t.stopImmediatePropagation(),t.preventDefault(),window.open(e(this).prop("href"),"_blank"),!1}),e(document).ajaxComplete(function(e,o,s){s.data!=t&&""!=s.data&&-1!=s.data.indexOf("action=query-attachments")&&L(),""!=a&&jQuery(".folder-modal ul.attachments li[data-id='"+a+"']").length&&!jQuery(".folder-modal ul.attachments li[data-id='"+a+"']").hasClass("selected")&&jQuery(".folder-modal ul.attachments li[data-id='"+a+"']").trigger("click")}),x=folders_media_options.terms,u=parseInt(folders_media_options.is_key_active),p=parseInt(folders_media_options.folders),r=folders_media_options.folder_settings,e(document).on("click",".header-posts a.all-posts",function(t){c=0,v="",d="all",e(".active-item").removeClass("active-item"),e(".jstree-clicked").removeClass("jstree-clicked"),e(this).addClass("active-item"),e(".sticky-folders .active-item").removeClass("active-item"),e(this).closest(".media-frame").find("#media-attachment-taxonomy-filter").val("all").trigger("change"),e(this).closest(".media-frame").find(".folder_for_media").val("all").trigger("change")}),e(document).on("click",".un-categorised-items",function(t){c=0,v="",d="unassigned",e(".active-item").removeClass("active-item"),e(".sticky-folders .active-item").removeClass("active-item"),e(".jstree-clicked").removeClass("jstree-clicked"),e(this).addClass("active-item"),e(this).closest(".media-frame").find("#media-attachment-taxonomy-filter").val("unassigned").trigger("change"),e(this).closest(".media-frame").find(".folder_for_media").val("-1").trigger("change")}),e(document).on("click","a.jstree-anchor",function(t){var o,s=e(this).closest("li.jstree-node").attr("id");d=c=s,e(this).closest(".folder-modal").find(".active-item").removeClass("active-item"),e(this).closest(".folder-modal").find("#media-attachment-taxonomy-filter").val(s),e(this).closest(".folder-modal").find("#media-attachment-taxonomy-filter").trigger("change"),thisSlug=V(s,"slug"),o=thisSlug,e.ajax({url:folders_media_options.ajax_url,type:"post",data:"action=save_folder_last_status&post_type="+folders_media_options.post_type+"&post_id="+o+"&nonce="+folders_media_options.nonce,cache:!1,async:!1,success:function(){}}),e(".custom-media-select").removeClass("active")}),e(document).on("change",".folder_for_media",function(){"add-folder"!=e(this).val()&&null!=e(this).val()?d=e(this).val():"add-folder"==e(this).val()&&(d=-1)}),e(document).on("click",".update-inline-record",function(a){var l;(a.stopImmediatePropagation(),a.stopPropagation(),0!=folders_media_options.can_manage_folder)&&(isHigh=e(this).closest("li.sticky-fldr").hasClass("is-high"),isLocked=e(this).closest("li.sticky-fldr").hasClass("is-locked"),isSticky=e(this).closest("li.sticky-fldr").hasClass("is-sticky"),isStickyClass=!!isSticky,e(".dynamic-menu").remove(),e(".active-menu").removeClass("active-menu"),menuHtml="<div class='dynamic-menu "+(isLocked?"is-locked":"")+" "+(I?"no-key":"")+" ' data-id='"+e(this).closest("li").data("folder-id")+"'><ul>",menuHtml+=I||s?"<li class='new-folder'><a href='javascript:;'><span class=''><i class='pfolder-add-folder'></i></span>New Sub-folder</a></li>":"<li class='new-folder-pro'><a href='javascript:;'><span class=''><i class='pfolder-add-folder'></i></span>New Sub-folder (Activate)</a></li>",menuHtml+="<li class='rename-folder'><a href='javascript:;'><span class=''><i class='pfolder-edit'></i></span>Rename</a></li>",menuHtml+=I?"<li class='sticky-folder'><a href='javascript:;'><span class='sticky-pin'><i class='pfolder-pin'></i></span>"+(isStickyClass?"Remove Sticky Folder":"Sticky Folder")+"</a></li>":"<li class='sticky-folder-pro'><a target='_blank' href='"+folders_media_options.register_url+"'><span class='sticky-pin'><i class='pfolder-pin'></i></span>Sticky Folder (Activate)</a></li>",menuHtml+=I||o?"<li class='mark-folder'><a href='javascript:;'><span class=''><i class='pfolder-star'></i></span>"+(isHigh?"Remove Star":"Add a Star")+"</a></li>":"<li class='mark-folder-pro'><a target='_blank' href='"+folders_media_options.register_url+"'><span class=''><i class='pfolder-star'></i></span>"+(isHigh?"Remove Star (Activate)":"Add a Star (Activate)")+"</a></li>",I?(menuHtml+="<li class='lock-folder'><a href='javascript:;'><span class='dashicons dashicons-"+(isLocked?"unlock":"lock")+"'></span>"+(isLocked?"Unlock Folder":"Lock Folder")+"</a></li>",menuHtml+="<li class='duplicate-folder'><a href='javascript:;'><span class=''><i class='pfolder-clone'></i></span>Duplicate folder</a></li>"):(menuHtml+="<li class='lock-folder-pro'><a target='_blank' href='"+folders_media_options.register_url+"'><span class='dashicons dashicons-lock'></span>Lock Folder (Activate)</a></li>",menuHtml+="<li class='duplicate-folder-pro'><a target='_blank' href='"+folders_media_options.register_url+"'><span class=''><i class='pfolder-clone'></i></span>Duplicate folder (Activate)</a></li>"),hasPosts=parseInt(e(this).closest("a.jstree-anchor").find(".premio-folder-count").text()),hasPosts&&(menuHtml+=I?"<li target='_blank' class='download-folder'><a href='javascript:;'><span class=''><i class='pfolder-zip-file'></i></span>Download Zip</a></li>":"<li target='_blank' class='download-folder-pro'><a target='_blank' href='"+folders_media_options.register_url+"'><span class=''><i class='pfolder-zip-file'></i></span>Download Zip (Activate)</a></li>"),menuHtml+="<li class='remove-folder'><a href='javascript:;'><span class=''><i class='pfolder-remove'></i></span>Delete</a></li></ul></div>",e("body").append(menuHtml),a.pageX==t||a.pageY==t?(e(".dynamic-menu").css("left",C),e(".dynamic-menu").css("top",S-10),l=S):(e(".dynamic-menu").css("left",a.pageX),e(".dynamic-menu").css("top",a.pageY),l=a.pageY),l+e(".dynamic-menu").height()>e(window).height()&&e(".dynamic-menu").css("margin-top",e(window).height()-(l+e(".dynamic-menu").height())))}),e(document).on("click","body, html",function(t){e(".dynamic-menu").remove(),e(".active-menu").removeClass("active-menu"),e(".folder-order").removeClass("active")}),e(document).on("click",".dynamic-menu, .folder-order",function(e){e.stopPropagation()}),e(document).on("contextmenu",".jstree-anchor",function(t){return C=t.pageX,S=t.pageY,e(this).find("span.folder-inline-edit").trigger("click"),!1}),e(document).on("click",".folder-actions span.folder-inline-edit",function(a){(a.stopImmediatePropagation(),a.stopPropagation(),0!=folders_media_options.can_manage_folder)&&(isHigh=e(this).closest("li.jstree-node").hasClass("is-high"),isLocked=e(this).closest("li.jstree-node").hasClass("is-locked"),isSticky=e(this).closest("li.jstree-node").hasClass("is-sticky"),isStickyClass=!!isSticky,e(".dynamic-menu").remove(),e(".active-menu").removeClass("active-menu"),menuHtml="<div class='dynamic-menu "+(isLocked?"is-locked":"")+" "+(I?"":"no-key")+"' data-id='"+e(this).closest("li").prop("id")+"'><ul>",menuHtml+=I||s?"<li class='new-folder'><a href='javascript:;'><span class=''><i class='pfolder-add-folder'></i></span>New Sub-folder</a></li>":"<li class='new-folder-pro'><a href='javascript:;'><span class=''><i class='pfolder-add-folder'></i></span>New Sub-folder (Activate)</a></li>",menuHtml+="<li class='rename-folder'><a href='javascript:;'><span class=''><i class='pfolder-edit'></i></span>Rename</a></li>",menuHtml+=I?"<li class='sticky-folder'><a href='javascript:;'><span class='sticky-pin'><i class='pfolder-pin'></i></span>"+(isStickyClass?"Remove Sticky Folder":"Sticky Folder")+"</a></li>":"<li class='sticky-folder-pro'><a target='_blank' href='"+folders_media_options.register_url+"'><span class='sticky-pin'><i class='pfolder-pin'></i></span>Sticky Folder (Activate)</a></li>",menuHtml+=I||o?"<li class='mark-folder'><a href='javascript:;'><span class=''><i class='pfolder-star'></i></span>"+(isHigh?"Remove Star":"Add a Star")+"</a></li>":"<li class='mark-folder-pro'><a target='_blank' href='"+folders_media_options.register_url+"'><span class=''><i class='pfolder-star'></i></span>"+(isHigh?"Remove Star (Activate)":"Add a Star (Activate)")+"</a></li>",I?(menuHtml+="<li class='lock-folder'><a href='javascript:;'><span class='dashicons dashicons-"+(isLocked?"unlock":"lock")+"'></span>"+(isLocked?"Unlock Folder":"Lock Folder")+"</a></li>",menuHtml+="<li class='duplicate-folder'><a href='javascript:;'><span class=''><i class='pfolder-clone'></i></span>Duplicate folder</a></li>"):(menuHtml+="<li class='lock-folder-pro'><a target='_blank' href='"+folders_media_options.register_url+"'><span class='dashicons dashicons-lock'></span>Lock Folder (Activate)</a></li>",menuHtml+="<li class='duplicate-folder-pro'><a target='_blank' href='"+folders_media_options.register_url+"'><span class=''><i class='pfolder-clone'></i></span>Duplicate folder (Activate)</a></li>"),hasPosts=parseInt(e(this).closest("a.jstree-anchor").find(".premio-folder-count").text()),hasPosts&&(menuHtml+=I?"<li target='_blank' class='download-folder'><a href='javascript:;'><span class=''><i class='pfolder-zip-file'></i></span>Download Zip</a></li>":"<li target='_blank' class='download-folder-pro'><a target='_blank' href='"+folders_media_options.register_url+"'><span class=''><i class='pfolder-zip-file'></i></span>Download Zip (Activate)</a></li>"),menuHtml+="<li class='remove-folder'><a href='javascript:;'><span class=''><i class='pfolder-remove'></i></span>Delete</a></li></ul></div>",e("body").append(menuHtml),a.pageX==t||a.pageY==t?(e(".dynamic-menu").css("left",C),e(".dynamic-menu").css("top",S-10)):(e(".dynamic-menu").css("left",a.pageX),e(".dynamic-menu").css("top",a.pageY),a.pageY),e(this).parents("li.jstree-node").addClass("active-menu"))}),e(document).on("click",".dynamic-menu",function(e){e.stopImmediatePropagation(),e.stopPropagation()}),e(document).on("click","body, html",function(){e(".dynamic-menu").remove()}),e(document).on("click",".new-folder-pro",function(t){e(".dynamic-menu").remove(),e("#sub-folder-popup").show()}),e(document).on("click",".new-folder",function(t){t.stopPropagation(),c=e(this).closest(".dynamic-menu").data("id"),e(".dynamic-menu").remove(),e(".active-menu").removeClass("active-menu"),y=!1,j=!1,G()}),e(document).on("click","#add-new-folder",function(t){c=e("#custom-menu li.active-item").length?e("#custom-menu li.active-item").data("folder-id"):0,y=!1,G()}),e(document).on("submit","#save-folder-form",function(t){if(t.stopPropagation(),t.preventDefault(),m=e("#add-update-folder-name").val(),""==e.trim(m))e(".folder-form-errors").addClass("active"),e("#add-update-folder-name").focus();else{e("#save-folder-data").html('<span class="dashicons dashicons-update"></span>'),e("#add-update-folder").addClass("disabled");var o=c;y&&(o=0),b=0==o?e("#js-tree-menu > ul > li.jstree-node").length:e("#js-tree-menu > ul > li.jstree-node[id='"+o+"'] > ul.jstree-children > li").length+1,e.ajax({url:folders_media_options.ajax_url,data:{parent_id:o,type:folders_media_options.post_type,action:"wcp_add_new_folder",nonce:folders_media_options.nonce,term_id:o,order:b,name:m,is_duplicate:j,duplicate_from:w},method:"post",success:function(t){if(result=e.parseJSON(t),e(".folder-popup-form").hide(),e(".folder-popup-form").removeClass("disabled"),-1==result.status)e("#no-more-folder-credit").show();else if("1"==result.status){if(u=parseInt(result.is_key_active),p=parseInt(result.folders),e("#current-folder").text(p),e("#ttl-fldr").text(10),K(),result.data.length)for(var o=0;o<result.data.length;o++){var s={folder_id:result.data[o].term_id,folder_count:0,is_sticky:result.data[o].is_sticky,is_high:result.data[o].is_high,is_locked:result.data[o].is_locked,nonce:result.data[o].nonce,slug:result.data[o].slug,is_deleted:0};r.push(s),e("#js-tree-menu").jstree().create_node(result.parent_id,{id:result.data[o].term_id,text:" "+result.data[o].title},"last",function(){e(".jstree-node[id='"+result.data[o].term_id+"']").attr("data-nonce",result.data[o].nonce),e(".jstree-node[id='"+result.data[o].term_id+"']").attr("data-slug",result.data[o].slug)})}ee(),E(),c=result.term_id,$(0)}else e("#error-folder-popup-message").html(result.message),e("#error-folder-popup").show()}})}return!1}),e(document).on("click",".form-cancel-btn",function(){e(".folder-popup-form").hide()}),e(document).on("click",".folder-popup-form",function(t){e(".folder-popup-form").hide()}),e(document).on("click",".popup-form-content",function(e){e.stopPropagation()}),document.onkeydown=function(t){("key"in(t=t||window.event)?"Escape"===t.key||"Esc"===t.key:27===t.keyCode)&&e(".folder-popup-form").hide()},e(document).on("click",".rename-folder",function(t){t.stopPropagation(),c=e(this).closest(".dynamic-menu").data("id"),W(),e(".dynamic-menu").remove()}),e(document).on("click","#inline-update",function(t){e("#js-tree-menu a.jstree-clicked").length&&(c=e("#js-tree-menu a.jstree-clicked").closest("li.jstree-node").attr("id"),W())}),e(document).on("submit","#update-folder-form",function(o){return o.stopPropagation(),o.preventDefault(),m=e("#update-folder-item-name").val(),""==e.trim(m)?(e(".folder-form-errors").addClass("active"),e("#update-folder-item-name").focus()):(e("#update-folder-data").html('<span class="dashicons dashicons-update"></span>'),e("#update-folder-item").addClass("disabled"),f=V(c,"nonce"),parentID=e(".jstree-node[id='"+c+"']").closest("li.jstree-node").attr("id"),parentID==t&&(parentID=0),e.ajax({url:folders_media_options.ajax_url,data:{parent_id:parentID,type:folders_media_options.post_type,action:"wcp_update_folder",nonce:f,term_id:c,order:b,name:m},method:"post",success:function(t){result=e.parseJSON(t),"1"==result.status?(e("#js-tree-menu").jstree("rename_node",result.id," "+result.term_title),e(".sticky-folder-"+result.id+" .folder-title").html(result.term_title),folderPostId=z(result.id),null!=folderPostId&&(r[folderPostId].nonce=result.nonce,r[folderPostId].slug=result.slug),e(".folder-popup-form").hide(),e(".folder-popup-form").hide(),e(".folder-popup-form").removeClass("disabled"),ee(),e("#media-attachment-taxonomy-filter").length&&$(0)):(e(".folder-popup-form").hide(),e(".folder-popup-form").removeClass("disabled"),e("#error-folder-popup-message").html(result.message),e("#error-folder-popup").show())}})),!1}),e(document).on("click",".mark-folder",function(t){t.stopPropagation(),n=e(this).closest(".dynamic-menu").data("id"),f=V(n,"nonce"),e(".form-loader-count").css("width","100%"),e(".dynamic-menu").remove(),e(".active-menu").removeClass("active-menu"),e.ajax({url:folders_media_options.ajax_url,data:"term_id="+n+"&type="+folders_media_options.post_type+"&action=wcp_mark_un_mark_folder&nonce="+f,method:"post",cache:!1,success:function(t){t=e.parseJSON(t),e(".form-loader-count").css("width","0%"),"1"==t.status?(folderPostId=z(t.id),"1"==t.marked?(e("li.jstree-node[id='"+t.id+"']").addClass("is-high"),e(".sticky-folder-"+t.id).addClass("is-high"),null!=folderPostId&&(r[folderPostId].is_high=1)):(e("li.jstree-node[id='"+t.id+"']").removeClass("is-high"),e(".sticky-folder-"+t.id).removeClass("is-high"),null!=folderPostId&&(r[folderPostId].is_high=0)),ee()):(e(".folder-popup-form").hide(),e(".folder-popup-form").removeClass("disabled"),e("#error-folder-popup-message").html(t.message),e("#error-folder-popup").show())}})}),e(document).on("click",".lock-folder",function(t){t.stopPropagation(),n=e(this).closest(".dynamic-menu").data("id"),f=V(n,"nonce"),e(".form-loader-count").css("width","100%"),e(".dynamic-menu").remove(),e(".active-menu").removeClass("active-menu"),e.ajax({url:folders_media_options.ajax_url,data:"term_id="+n+"&type="+folders_media_options.post_type+"&action=wcp_lock_unlock_folder&nonce="+f,method:"post",cache:!1,success:function(t){t=e.parseJSON(t),e(".form-loader-count").css("width","0%"),"1"==t.status?(folderPostId=z(t.id),"1"==t.marked?(e("li.jstree-node[id='"+t.id+"']").addClass("is-locked"),e(".sticky-folder-"+t.id).addClass("is-locked"),null!=folderPostId&&(r[folderPostId].is_locked=1)):(e("li.jstree-node[id='"+t.id+"']").removeClass("is-locked"),e(".sticky-folder-"+t.id).removeClass("is-locked"),null!=folderPostId&&(r[folderPostId].is_locked=0)),ee()):(e(".folder-popup-form").hide(),e(".folder-popup-form").removeClass("disabled"),e("#error-folder-popup-message").html(t.message),e("#error-folder-popup").show())}})}),e(document).on("click",".duplicate-folder",function(t){t.stopPropagation(),c=e(this).closest(".dynamic-menu").data("id"),e(".dynamic-menu").remove(),y=!1,j=!0,G()}),e(document).on("click",".remove-folder",function(){e(this).closest(".dynamic-menu").hasClass("is-locked")||(n=e(this).closest(".dynamic-menu").data("id"),c=e(this).closest(".dynamic-menu").data("id"),Z(0),e(".dynamic-menu").remove(),e(".active-menu").removeClass("active-menu"))}),e(document).on("click","#remove-folder-item",function(t){t.stopPropagation(),e(".folder-popup-form").addClass("disabled"),e("#remove-folder-item").html('<span class="dashicons dashicons-update"></span>'),f=V(c,"nonce"),k?function(){if(e("#folder-hide-show-checkbox").is(":checked")&&e("#js-tree-menu input.checkbox:checked").length>0){var t="";e("#js-tree-menu input.checkbox:checked").each(function(){t+=e(this).closest("li.jstree-node").attr("id")+",",e(this).closest("li.jstree-node").hasClass("jstree-clicked")&&!0}),e(".form-loader-count").css("width","100%"),e.ajax({url:folders_media_options.ajax_url,data:"type="+folders_media_options.post_type+"&action=wcp_remove_muliple_folder&term_id="+t+"&nonce="+folders_media_options.nonce,method:"post",success:function(t){if(t=e.parseJSON(t),e(".form-loader-count").css("width","0px"),"1"==t.status){for(u=parseInt(t.is_key_active),p=parseInt(t.folders),e("#current-folder").text(p),i=0;i<t.term_ids.length;i++)e(".folder-modal #js-tree-menu").jstree().delete_node(t.term_ids[i]);e("#ttl-fldr").text(10),ee(),e(".folder-popup-form").hide(),e(".folder-popup-form").removeClass("disabled"),B(),E(),ee(),e(".folder-modal #wcp_folder_"+v).length||(e(".header-posts a").trigger("click"),v=0)}else window.location.reload();e("#folder-hide-show-checkbox").attr("checked",!1),e("#js-tree-menu input.checkbox").attr("checked",!1),e("#js-tree-menu").removeClass("show-folder-checkbox")}})}}():e.ajax({url:folders_media_options.ajax_url,data:"type="+folders_media_options.post_type+"&action=wcp_remove_folder&term_id="+c+"&nonce="+f,method:"post",success:function(t){"1"==(t=e.parseJSON(t)).status?(e("#js-tree-menu").jstree().delete_node(c),u=parseInt(t.is_key_active),p=parseInt(t.folders),e("#current-folder").text(p),e("#ttl-fldr").text(10),e(".sticky-folders .sticky-folder-"+c).remove(),ee(),e(".folder-popup-form").hide(),e(".folder-popup-form").removeClass("disabled"),B(),E(),v==c&&e(".header-posts").trigger("click")):(e(".folder-popup-form").hide(),e(".folder-popup-form").removeClass("disabled"),e("#error-folder-popup-message").html(t.message),e("#error-folder-popup").show())}})}),e(document).on("click","#sort-order-list",function(t){t.stopPropagation(),e(".folder-order").toggleClass("active")}),e(document).on("click","#expand-collapse-list",function(t){t.stopPropagation();var o=0;e(this).hasClass("all-open")?(e(this).removeClass("all-open"),o=0,e(this).attr("data-folder-tooltip","Expand"),e("#js-tree-menu").jstree("close_all")):(e(this).addClass("all-open"),o=1,e(this).attr("data-folder-tooltip","Collapse"),e("#js-tree-menu").jstree("open_all")),g="",e("#js-tree-menu .jstree-node:not(.jstree-leaf)").each(function(){g+=e(this).attr("id")+","}),""!=g&&(e(".form-loader-count").css("width","100%"),f=folders_media_options.nonce,e.ajax({url:folders_media_options.ajax_url,data:"type="+folders_media_options.post_type+"&action=wcp_change_all_status&status="+o+"&folders="+g+"&nonce="+f,method:"post",success:function(t){e(".form-loader-count").css("width","0"),"0"==(t=e.parseJSON(t)).status&&(e(".folder-popup-form").hide(),e(".folder-popup-form").removeClass("disabled"),e("#error-folder-popup-message").html(t.message),e("#error-folder-popup").show(),window.location.reload(!0))}}))}),e(document).on("click",".folder-sort-menu a",function(t){t.stopPropagation(),t.preventDefault(),e(".form-loader-count").css("width","100%"),e(".folder-order").removeClass("active"),e(this).attr("data-sort"),e.ajax({url:folders_media_options.ajax_url,data:"type="+folders_media_options.post_type+"&action=wcp_folders_by_order&nonce="+folders_media_options.nonce+"&order="+e(this).attr("data-sort"),method:"post",success:function(t){1==(t=e.parseJSON(t)).status&&(e("#js-tree-menu").jstree().destroy(),e("#js-tree-menu").append("<ul></ul>"),e("#js-tree-menu ul").html(t.data),x=t.terms,X(),T()),e(".form-loader-count").css("width","0"),R()}})}),e(document).on("click",".jstree-node .jstree-icon",function(){n=e(this).closest("li.jstree-node").attr("id"),e("li.jstree-node[id='"+n+"']").hasClass("jstree-open")?folderStatus=1:folderStatus=0,e(".form-loader-count").css("width","100%"),f=V(n,"nonce"),K(),e.ajax({url:folders_media_options.ajax_url,data:"is_active="+folderStatus+"&action=save_wcp_folder_state&term_id="+n+"&nonce="+f,method:"post",success:function(t){e(".form-loader-count").css("width","0"),"0"==(t=e.parseJSON(t)).status||(e("#wcp_folder_"+n).hasClass("active")?(e("#wcp_folder_"+n).removeClass("active"),e("#wcp_folder_"+n).find("ul.ui-sortable:first-child > li").slideUp(),folderStatus=0):(e("#wcp_folder_"+n).addClass("active"),e("#wcp_folder_"+n).find("ul.ui-sortable:first-child > li").slideDown(),folderStatus=1),ee())}})}),e(document).on("keyup","#folder-search",function(){q()}),e(document).on("change","#folder-search",function(){q()}),e(document).on("blur","#folder-search",function(){q()}),e(document).on("click","#folder-hide-show-checkbox",function(){e(this).is(":checked")?e("#js-tree-menu").addClass("show-folder-checkbox"):(e("#js-tree-menu input.checkbox").attr("checked",!1),e("#js-tree-menu").removeClass("show-folder-checkbox"))}),e(document).on("click",".folder-checkbox, .input-checkbox",function(e){e.stopImmediatePropagation(),e.stopPropagation()}),e(document).on("click",".jstree-node .jstree-icon",function(t){n=e(this).closest("li.jstree-node").attr("id"),e("li.jstree-node[id='"+n+"']").hasClass("jstree-open")?folderStatus=0:folderStatus=1,e(".form-loader-count").css("width","100%"),f=V(n,"nonce"),K(),e.ajax({url:folders_media_options.ajax_url,data:"is_active="+folderStatus+"&action=save_wcp_folder_state&term_id="+n+"&nonce="+f,method:"post",success:function(t){e(".form-loader-count").css("width","0"),"0"==(t=e.parseJSON(t)).status||(e("#wcp_folder_"+n).hasClass("active")?(e("#wcp_folder_"+n).removeClass("active"),e("#wcp_folder_"+n).find("ul.ui-sortable:first-child > li").slideUp(),folderStatus=0):(e("#wcp_folder_"+n).addClass("active"),e("#wcp_folder_"+n).find("ul.ui-sortable:first-child > li").slideDown(),folderStatus=1),ee())}})}),e(document).on("click","#inline-remove",function(){e("#folder-hide-show-checkbox").is(":checked")?(e(".dynamic-menu").remove(),Z(1)):e("#js-tree-menu a.jstree-clicked").length&&(e("#js-tree-menu a.jstree-clicked").closest(".jstree-node").hasClass("is-locked")||(c=e("#js-tree-menu a.jstree-clicked").closest("li.jstree-node").attr("id"),Z(1),e(".dynamic-menu").remove(),e(".active-menu").removeClass("active-menu")))}),e(document).on("click",".sticky-folder",function(t){t.stopPropagation(),n=e(this).closest(".dynamic-menu").data("id");var o=0;folderPostId=z(n),e("li.jstree-node[id='"+n+"']").hasClass("is-sticky")?(e("li.jstree-node[id='"+n+"']").removeClass("is-sticky"),e(".sticky-folders .sticky-folder-"+c).remove(),null!=folderPostId&&(r[folderPostId].is_sticky=0)):(o=1,e("li.jstree-node[id='"+n+"']").addClass("is-sticky"),null!=folderPostId&&(r[folderPostId].is_sticky=1)),e(".dynamic-menu").hide(),f=V(n,"nonce"),E(),e.ajax({url:folders_media_options.ajax_url,data:"term_id="+n+"&type="+folders_media_options.post_type+"&action=wcp_make_sticky_folder&nonce="+f+"&status="+o,method:"post",cache:!1,success:function(e){}})}),e(document).on("click",".download-folder",function(t){n=e(this).closest(".dynamic-menu").data("id"),dataNonce=V(n,"nonce"),window.location=folders_media_options.admin_url+"?action=download-folders&folder_id="+n+"&nonce="+dataNonce}),e(document).on("click",".sticky-folders > ul > li > a",function(t){t.stopPropagation();var o=e(this).closest("li").data("folder-id");e(".jstree-node[id='"+o+"']").length&&(e(".jstree-clicked").removeClass("jstree-clicked"),e(".active-item").removeClass("active-item"),e("#js-tree-menu").jstree("select_node",v),e(".jstree-node[id='"+o+"'] > a.jstree-anchor").trigger("click"),e(".jstree-node[id='"+o+"'] > a.jstree-anchor").addClass("jstree-clicked"),e(".sticky-folders .sticky-folder-"+o+" a").addClass("active-item"))}),e(document).on("contextmenu",".sticky-fldr >  a",function(t){return t.stopPropagation(),C=t.pageX,S=t.pageY,e(this).find("span.update-inline-record").trigger("click"),!1}),e(document).on("change",".folder_for_media",function(){"add-folder"==e(this).val()&&(y=!0,e("#add-new-folder").trigger("click"))}),e(document).on("click","#custom-menu .ui-icon, #custom-menu h3",function(){e("#custom-menu .active-item").removeClass("active-item"),e(this).closest(".route").addClass("active-item")}),e(document).on("click",".media-menu button.media-menu-item, .media-button-insert",function(){Y()})})});